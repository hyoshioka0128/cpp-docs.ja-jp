---
description: '詳細情報: `scanf` 幅指定'
title: scanf での文字幅指定
ms.date: 10/22/2019
helpviewer_keywords:
- scanf function, width specification
ms.assetid: 94b4e8fe-c4a2-4799-8b6c-a2cf28ffb09c
ms.openlocfilehash: f4b0e13ef87add74bc802ba11ea6b87d0dfc6b8a
ms.sourcegitcommit: d6af41e42699628c3e2e6063ec7b03931a49a098
ms.translationtype: MT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/11/2020
ms.locfileid: "97284435"
---
# <a name="scanf-width-specification"></a>`scanf` 幅の指定

この情報は、`scanf_s` など、安全なバージョンを含む `scanf` 関数ファミリの書式指定文字列の解釈に適用されます。 これらの関数は通常、入力ストリームが一連のトークンに分割されていることを前提とします。 トークンは、空白 (スペース、タブ、または改行) で区切られます。数値型の場合は、数値テキストに変換できない最初の文字によって示される数値データ型の自然な終端によって区切られます。 ただし、幅指定を使用すると、トークンの自然な終了の前に入力の解析が停止することがあります。

*幅* の指定は、と型フィールド指定子の間の文字で構成 `%` されます。これには、 *width* フィールドと呼ばれる正の整数と、フィールドのサイズを示す1つ以上の文字が含まれます。これは、整数型がかどうかを示すなど、フィールドの型の修飾子としても考えられ **`short`** **`long`** ます。 このような文字はサイズのプレフィックスと呼ばれます。

## <a name="the-width-field"></a>[幅] フィールド

*Width* フィールドは、そのフィールドに対して読み取る最大文字数を制御する正の10進整数です。 *全角* 文字を超える文字は変換されず、対応するに格納され `argument` ます。 指定された書式に従って変換できない空白文字または文字が、*幅* に達する前に出現する場合は、*幅* がより小さい文字が読み取られます。

幅の指定は、これらの関数のセキュリティで保護されたバージョンに必要なバッファーサイズ引数とは別のものです (たとえば、、など `scanf_s` `wscanf_s` )。 次の例では、幅指定は 20 であり、入力ストリームから 20 文字までが読み取られることを示してます。 バッファー長は 21 であり、入力可能な 20 文字の空きと、null 終端文字が含まれています。

```C
char str[21];
scanf_s("%20s", str, 21);
```

*Width* フィールドが使用されていない場合、は `scanf_s` トークン全体の文字列への読み取りを試みます。 指定されたサイズがトークン全体を保持するのに十分な大きさではない場合、対象の文字列には何も書き込まれません。 *Width* フィールドが指定されている場合、トークン内の最初の *幅* の文字が、null ターミネータと共にコピー先の文字列に書き込まれます。

## <a name="the-size-prefix"></a>サイズプレフィックス

省略可能なプレフィックス **h**、 **hh**、 **l**、 **ll**、 **I64**、 **l** は、 `argument` (変更する型文字に応じて) のサイズ (long または short、1バイト文字またはワイド文字) を示します。 これらの書式指定文字列は、`scanf` または `wscanf` 関数で使用され、次の表に示す引数の解釈を指定します。 型プレフィックス **I64** は Microsoft 拡張機能であり、標準 C と互換性がありません。型文字とその意味については、「 [ `scanf` 型フィールド文字](../c-runtime-library/scanf-type-field-characters.md)」の「Scanf 関数の型文字」を参照してください。

> [!NOTE]
> **H**、 **l**、および **l** プレフィックスは、型のデータと共に使用する場合の Microsoft 拡張機能です **`char`** 。

### <a name="size-prefixes-for-scanf-and-wscanf-format-type-specifiers"></a>`scanf` `wscanf` 型と書式指定子のサイズプレフィックス

|指定する型|プリフィックス|型指定子|
|----------------|----------------|-------------------------|
|**`double`**|**l**|**e**、**E**、**f**、**g**、または **G**|
|**`long double`** (と同じ **`double`** )|**L**|**e**、**E**、**f**、**g**、または **G**|
|**`long int`**|**l**|**d**、**i**、**o**、**x**、または **X**|
|**`long unsigned int`**|**l**|**u**|
|**`long long`**|**ご覧**|**d**、**i**、**o**、**x**、または **X**|
|**`short int`**|**h**|**d**、**i**、**o**、**x**、または **X**|
|**`short unsigned int`**|**h**|**u**|
|**`char`**|**hh**|**d**、**i**、**o**、**x**、または **X**|
|**`unsigned char`**|**hh**|**u**|
|**`int64`**|**I64**|**d**、**i**、**o**、**u**、**x**、または **X**|
|1 バイト文字と `scanf`|**h**|**c** または **c**|
|1 バイト文字と `wscanf`|**h**|**c** または **c**|
|ワイド文字と `scanf`|**l**|**c** または **c**|
|ワイド文字と `wscanf`|**l**|**c** または **c**|
|1バイト文字列と `scanf`|**h**|**s** または **S**|
|1バイト文字列と `wscanf`|**h**|**s** または **S**|
|ワイド文字列と `scanf`|**l**|**s** または **S**|
|ワイド文字列と `wscanf`|**l**|**s** または **S**|

次の例では、**h** と **l** を `scanf_s` 関数と `wscanf_s` 関数で使用します:

```C
scanf_s("%ls", &x, 2);     // Read a wide-character string
wscanf_s(L"%hC", &x, 2);    // Read a single-byte character
```

`scanf` ファミリの安全でない関数を使用する場合は、前の引数のバッファー長を示すサイズ パラメーターを省略します。

## <a name="reading-undelimited-strings"></a>区切られていない文字列の読み取り

空白文字で区切られていない文字列を読み取るには、角かっこ () で囲まれた文字のセットを **`[ ]`** **s** (文字列) 型の文字に置き換えることができます。 角かっこ内の文字のセットは、 *制御文字列* と呼ばれます。 対応する入力フィールドは、コントロール文字列に表示されない最初の文字まで読み取られます。 セット内の最初の文字がキャレット () の場合 **`^`** 、効果は逆になります。入力フィールドは、文字セットの残りの部分に表示される最初の文字まで読み取られます。

% [A-z **]** と **% [z-a]** は、どちらも **% [abcde...z...z]**。 これは共通の `scanf` 関数拡張ですが、標準 C では必須ではありません。

## <a name="reading-unterminated-strings"></a>未終了の文字列の読み取り

終端の null 文字 (' \ 0 ') を格納せずに文字列を格納するには、指定を使用し `%Nc` ます。ここで、 *N* は10進整数です。 この場合、**c** の型文字は引数が文字配列へのポインターであることを示します。 次の *N* 文字が入力ストリームから指定された場所に読み取られ、null 文字 (' \ 0 ') は追加されません。 *N* が指定されていない場合の既定値は1です。

## <a name="when-scanf-stops-reading-a-field"></a>`scanf`がフィールドの読み取りを停止するとき

`scanf`関数は文字単位で入力フィールドをスキャンします。 次のいずれかの理由により、空白文字に到達する前に特定の入力フィールドの読み取りを停止する場合があります。

- 指定した幅に到達しました。

- 次の文字は、指定されたとおりに変換できません。

- 次の文字が、一致すると考えられる制御文字列内の文字と競合しています。

- 次の文字が特定の文字セットに表示されません。

理由に関係なく、`scanf` 関数が入力フィールドの読み取りを停止すると、次の入力フィールドは、最初の未読文字から始まるとみなされます。 競合する文字 (存在する場合) は、未読と見なされます。 これは、次の入力フィールドの最初の文字、または入力ストリームに対する後続の読み取り操作の最初の文字です。

## <a name="see-also"></a>関連項目

[`scanf`, `_scanf_l`, `wscanf`, `_wscanf_l`](../c-runtime-library/reference/scanf-scanf-l-wscanf-wscanf-l.md)<br/>
[`scanf_s`, `_scanf_s_l`, `wscanf_s`, `_wscanf_s_l`](../c-runtime-library/reference/scanf-s-scanf-s-l-wscanf-s-wscanf-s-l.md)<br/>
[書式指定フィールド: `scanf` および `wscanf` 関数](../c-runtime-library/format-specification-fields-scanf-and-wscanf-functions.md)<br/>
[`scanf` 型フィールド文字](../c-runtime-library/scanf-type-field-characters.md)<br/>
